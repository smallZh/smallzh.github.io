# 传输层

核心任务是为**应用进程**之间提供**端到端的逻辑通信**服务

使用**IP地址+端口号**来唯一标识**一个通信端点**

## 提供的基本服务
1. 传输层寻址
1. 对**应用层报文**进行**分段和重组**
2. 对报文进行差错校验
3. 实现**进程间端到端**可靠数据传输控制
4. 面向应用层实现**复用**与**分解**
5. 实现端到端的**流量控制**
6. 拥塞控制

## 分类
分为两类：
1. 无连接服务：提供无连接、不可靠的数据报传输服务，如，UDP协议
2. 面向连接服务：提供面向连接的、可靠的、有序的字节流传输服务，如，TCP协议

## 复用与分解
支持众多应用进程**共用同一个传输层协议**，并能够将接收到的数据**准确交付**给不同的应用进程

无连接服务，如UDP，是一个<目的IP地址，目的端口号>的二元组

面向连接服务，如TCP，是一个<源IP地址，源目的端口号，目的IP地址，目的端口号>的四元组

## 可靠数据传输基本原理
采用的5种措施：
1. 差错检测：利用**差错编码**实现数据包传输过程中的比特差错检测（甚至纠正）
2. 确认：接收方向发送方反馈接收状态。
3. 重传：发送方重新发送接收方没有正确接收的数据。
4. 序号：确保数据按序提交。
5. 计时器：解决数据丢失问题。

最具代表性的协议是：停-等协议、滑动窗口协议

### 停-等协议
分为4步：
1. 发送方发送经过差错编码和编号的报文段，等待接收方的确认；
2. 接收方如果正确接收报文段，即差错检测无误且序号正确，则接收报 文段，并向发送方发送 ACK；
3. 否则丢弃报文段，并向发送方发送NAK；
4. 发送方如果收到ACK，则继续发送后续报文段，否则重发刚刚发送的 报文段。

### 滑动窗口协议
1. 分组连续编号；
2. 以流水线方式依次发送分组；
3. 接收方接收分组，按分组序号向上有序提交；
4. 通过确认向发送方通告正确接收的分组序号；
5. 发送方根据收到的ACK的序号以及计时器的，重新发送或者继续发送新分组。

典型的两个协议：
TCP协议
UDP协议

## UDP协议
用户数据包协议

包结构：源端口、目的端口、长度、校验和、数据段

## TCP协议
传输控制协议

“三次握手”
