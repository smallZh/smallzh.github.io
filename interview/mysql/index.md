## 索引相关题目
---
## 可以使用多少列创建索引？⭐ :id=index-num
任何标准表最多可以创建 16 个索引列。

## MySQL索引实现原理? ⭐⭐⭐⭐ :id=index-tenet
MySQ索引的原理和数据结构能介绍一下吗、MySQL聚簇索弓|和非聚簇索引的区别是什 么、他们分别是如何存储的？使用MySQL索引都有哪些原则、MySQL复合索引如何使 用。

基本会涉及这些知识点，稍微好点公司的面试官哈。

**索引存储结构**

其实大多面试官问你mysql的索引底层是什么数据结构实现的，可能还会现场让你优化 sql,为什么如此优化呢；还可能问你数据库常见的使用规则呢。
mysql的索引就是用一个数据结构组织某一列的数据，然后如果你要根据那一列的数据 查询的时候，就可以不用全表扫描，只要根据那个特定的数据结构去找到那一列的值， 然后找到对应的行的物理地址即可。
mysql的索引实现是基于B+树，这样查找数据的高度就算数据量很大，也很低，关于B+ 树原理和实现，可以参考任何一本数据结构的书籍了解下哈。
myisam存储弓|擎的索引中，每个叶子节点的data存放的是数据行的物理地址，比如 0x07之类的东西，一彳I亍的，鲂亍对应一^理毗。
innodb存储弓|擎的索引实现，跟myisam最大的区别在于，innodb的数据文件本身就是 个索引文件，就是key就是主键，然后叶子节点的data就是那个数据行。
innodb存储引擎，必须有主键，可以默认内置的就会根据主键（6字节的rowid）建立一 个索引，叫做聚簇索引，innodb的数据文件本身同时也是个索引文件，这个索引就是默 认根据主键建立的叫做聚簇索引。
innodb这种原生的数据文件就是索引文件的组织结构，就叫默认的主键索引为聚簇索 弓I。就是因为这个原因，innodb表是要求必须有主键的，但是myisam表不要求必须有 主键。另外f是，innodb存储引擎下，如果对某个非主键的字段创建个索引，那么最 后那个叶子节点的值就是主键的值，因为可以用主键的值到聚簇索引里根据主键值再次 查找到数据。
—般innodb表里，建议统—用auto_i ncrement自增值作为主键值，因为这样可以保 持聚簇索引直接加记录就可以，如果用那种不是单调递增的主键值，可能会导致b+树分 裂后重新组织，会浪费时间。这也就是为啥innodb下不要用UUID生成的超长字符串作 为主键？因为这么玩儿会导致所有的索引的data都是那个主键值，最终导致索引会变得 过大，浪费很多磁盘空间。

**索引使用规则**

1. 全列匹配
尽量where条件里，根据最左匹配原则，建立联合索引。比如 
```sql
select name,place_id from car_parking_place where car_id=xxxx and ctime=2018-01-10 00： 00:00 1 ;
```
就可以建立 create index (car_id,ctime)

1. 最左前缀匹配

如果你的sql里，正好就用到了联合索引最左边的一个或者几个列表，那么也可以用上 这个索引，在索引里查找的时候就用最左边的几个列。

1. 前缀匹配
如果你不是等值的，比如=, >=, <=的操作，是like操作，那么必须要是like ，xx%，这种才可以用上索引。
1. 范围列匹配
如果你是范围查询，比如>=,<=,between操作，你只能是符合最左前缀的规则才 可以范围，范围之后的列就不用索引。
1. 禁用函数
目前mysql还不支持函数索引，如果你对某个歹U用了函数，比如substring之类的东西, 那么那一列不用索引。

**素引的缺点**

索引是有缺点的，比如常见的就是会增加磁盘消耗，因为要占用磁盘文件，同时高并发 的时候频繁插入和修改索引，会导致性能损耗的。尽量创建少的索引，比如说一个表一 两个索引，两三个索引，十几个索引，高并发场景下还可以。

尽量对表中唯f 相对较高、经常查询的字段建立索引，那种比如sex （性别）,世上就 男女可能2种值，建立索引，几乎跟全表扫描没什么区别。